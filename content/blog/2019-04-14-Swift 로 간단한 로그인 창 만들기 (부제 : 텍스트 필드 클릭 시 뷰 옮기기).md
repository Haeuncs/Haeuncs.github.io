---
title: Swift 로 간단한 로그인 창 만들기
date: 2019-04-14 00:00:00
categories:
  - Swift
tags:
  - Swift
  - 스위프트
---

부제 : 텍스트 필드 클릭 시 뷰 옮기기

Swift 로 간단한 로그인 창을 만들고, autoLayout을 이용하여 뷰를 이동시키는 방법에 대해서 알아봅니다.

또한 뷰의 다른 곳을 터치했을 때, 키보드가 사라지게 합니다.

### 오늘 만들 결과물

<img src="/assets/images/19-04-15/IMG_1265.PNG" width="300" />
<br/>
<img src="/assets/images/19-04-15/IMG_1283.PNG" width="300" />

텍스트 필드 전에는 가운데 정렬이 되어 보이고, 텍스트 필드 선택 시에는 키보드 높이만큼을 제외한 뷰에서 가운데 정렬이 해서 보이게 만들 것 입니다.

#### 주의

약간의 삽질이 필요했습니다.<br />
키보드에서 FaceId로 인식이 거절되고, 뜨는 alert에서 취소를 누를 시에 keyBoardShow가 2번 실행이 됩니다. <br />
Anchor 의 isActive 가 다른 높이로 2번 true되는 현상을 방지하기 위해 조건문을 단 모습을 볼 수 있을 것 입니다. <br/>

> 시뮬레이터로 돌릴 시에는 하드웨어 키보드가 보여야지 제대로 작동합니다. (하드웨어 키보드 보이기 : ⌘ + K)

#### 전체 코드

별도의 storyboard 없이 복사 붙여넣기를 하면 바로 보이게 됩니다 <br/>

### 실제 실행 결과는

<img src="/assets/images/19-04-15/screen.png" width="300" />

<br/>
<img src="/assets/images/19-04-15/screen2.png" width="300" />

텍스트 뷰 클릭 시 뷰가 자동으로 위로 올라가는 것이 보이면 정상입니다.

> 첫 이미지의 텍스트 필드를 사용하고 싶으면 'AnimatedTextInput' 라이브러리를 검색하세요.

```Swift
//
// ViewController.swift
// 190415
//
// Created by OOPSLA on 15/04/2019.
// Copyright © 2019 haeun. All rights reserved.
//

import UIKit

class ViewController: UIViewController {

    private var mainViewCenterYanchor: NSLayoutConstraint?
    private var mainViewTopAnchor: NSLayoutConstraint?
    private var checkShow = false



    override func viewDidLoad() {
        super.viewDidLoad()
    }

    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)

        initView()

        NotificationCenter.default.addObserver(
            self,
            selector: #selector(keyboardWillShow),
            name: UIResponder.keyboardWillShowNotification,
            object: nil
        )
        NotificationCenter.default.addObserver(
            self,
            selector: #selector(keyboardWillHide),
            name: UIResponder.keyboardWillHideNotification,
            object: nil
        )
    }

    @objc func moveView() {
        self.navigationController?.pushViewController(ViewController(), animated: true)
    }
    // 키보드 올라오거나 내려갈 때 뷰 이동시키는 함수
    fileprivate func handleKeyboardIssue(notification: Notification, isAppearing: Bool) {
        // 1. 키보드 높이 구함
        guard let keyboardFrame = (notification.userInfo?[UIResponder.keyboardFrameEndUserInfoKey] as? NSValue)?.cgRectValue else {return}

        let keyboardHeight = keyboardFrame.height

        let heightConstant = isAppearing ? keyboardHeight : 0

        // 2. 어차피 모든 뷰는 mainView에 귀속되어있기 때문에 mainView 의 centerYanchor 를 topAnchor 로 바꿈
        let topSize = (self.view.frame.height - heightConstant) - mainView.frame.height

        if checkShow {
            if mainViewTopAnchor != nil {
                // 키보드의 자동 passWords 가 얼굴 인식을 못하고 취소를 누르면 keyboardWillShow가 두번 실행되기 때문에 만약 true일 때 false로 한번 해주고 해야함.

                // 더 설명을 하자면 initView에서 mainViewTopAnchor 가 isActive가 true되어 있고
                // 조건문이 없었다면 새로운 mainViewTopAnchor 를 선언한 채로 또 isActive 를 true 하면
                // 둘 중 무엇을 선택할 지 모름으로 true 일 때, false 해주고 새로운 mainViewTopAnchor를 true 한다.
                if mainViewTopAnchor!.isActive{
                    mainViewTopAnchor!.isActive = false
                }
            }
            mainViewCenterYanchor?.isActive = false
            mainViewTopAnchor = mainView.topAnchor.constraint(equalTo: self.view.topAnchor, constant: topSize/2)
            mainViewTopAnchor!.isActive = true
        }else{
            mainViewTopAnchor!.isActive = false
            mainViewCenterYanchor?.isActive = true
        }

        UIView.animate(withDuration: 1) {
            self.view.layoutIfNeeded()
        }
    }

    @objc func keyboardWillHide(_ notification: Notification){
        print("Keyboard hide")
        checkShow = false
        handleKeyboardIssue(notification: notification, isAppearing: false)
    }

    @objc func keyboardWillShow(_ notification: Notification){
        print("Keyboard show")
        checkShow = true
        handleKeyboardIssue(notification: notification, isAppearing: true)
    }

    let mainView : UIView = {
        let view = UIView()
        view.translatesAutoresizingMaskIntoConstraints = false
        return view
    }()
    let ID_textField : UITextField = {
        let text = UITextField()
        text.placeholder = "아이디"
        text.translatesAutoresizingMaskIntoConstraints = false
        return text
    }()

    let Pass_textField : UITextField = {
        let text = UITextField()
        text.placeholder = "비밀번호"
        text.isSecureTextEntry = true
        text.translatesAutoresizingMaskIntoConstraints = false
        return text
    }()

    let enter_Btn : UIButton = {
        let button  = UIButton()

// button.isEnabled = false
// button.setTitle("정보를 정확히 입력해주세요.", for: .disabled)
button.setTitle("확인", for: .normal)
button.backgroundColor = #colorLiteral(red: 0, green: 0.6043059826, blue: 0.614680171, alpha: 1)
button.layer.cornerRadius = 10
button.titleLabel?.font = UIFont.systemFont(ofSize: 15, weight: .heavy)
button.setTitleColor(UIColor.white, for: .normal)
button.translatesAutoresizingMaskIntoConstraints = false
return button
}()
let signInLabel : UILabel = {
let label = UILabel()
label.translatesAutoresizingMaskIntoConstraints = false
label.text = "계정이 없으신가요? "
label.textColor = .gray
label.font = UIFont.systemFont(ofSize: 13, weight: .medium)
return label
}()
let signInButton : UIButton = {
let button = UIButton()
button.translatesAutoresizingMaskIntoConstraints = false
button.setTitle("가입하기", for: .normal)
button.titleLabel?.font = UIFont.systemFont(ofSize: 15, weight: .heavy)
button.setTitleColor(UIColor.gray, for: .normal)
return button
}()
let signView : UIView = {
let view = UIView()
view.translatesAutoresizingMaskIntoConstraints = false
return view
}()
// MARK : Set View
private func initView(){
hideKeyboardWhenTappedAround()
signView.addSubview(signInLabel)
signView.addSubview(signInButton)

        mainView.addSubview(ID_textField)
        mainView.addSubview(Pass_textField)
        mainView.addSubview(enter_Btn)
        mainView.addSubview(signView)

        view.addSubview(mainView)

        enter_Btn.addTarget(self, action: #selector(moveView), for: .touchDown)

        let margin = CGFloat(20)

        mainViewCenterYanchor = mainView.centerYAnchor.constraint(equalTo: view.centerYAnchor, constant: 0)
        mainViewCenterYanchor?.isActive = true


        NSLayoutConstraint.activate([

            mainView.widthAnchor.constraint(equalToConstant: view.frame.width),

            ID_textField.topAnchor.constraint(equalTo: mainView.topAnchor, constant: 0),
            ID_textField.leadingAnchor.constraint(equalTo: view.leadingAnchor, constant: margin),
            ID_textField.trailingAnchor.constraint(equalTo: view.trailingAnchor, constant: -margin),
            ID_textField.bottomAnchor.constraint(equalTo: Pass_textField.topAnchor, constant: 0),

            Pass_textField.leadingAnchor.constraint(equalTo: view.leadingAnchor, constant: margin),
            Pass_textField.trailingAnchor.constraint(equalTo: view.trailingAnchor, constant: -margin),
            Pass_textField.bottomAnchor.constraint(equalTo: enter_Btn.topAnchor, constant: -10),

            enter_Btn.leadingAnchor.constraint(equalTo: view.leadingAnchor, constant: 40),
            enter_Btn.trailingAnchor.constraint(equalTo: view.trailingAnchor, constant: -40),
            enter_Btn.heightAnchor.constraint(equalToConstant: 50),

            signView.topAnchor.constraint(equalTo: enter_Btn.bottomAnchor, constant: 40),
            signView.centerXAnchor.constraint(equalTo: view.centerXAnchor, constant: 0),
            signView.heightAnchor.constraint(equalToConstant: 40),
            signView.bottomAnchor.constraint(equalTo: mainView.bottomAnchor, constant: 0),

            signInLabel.centerYAnchor.constraint(equalTo: signView.centerYAnchor, constant: 0),
            signInLabel.leadingAnchor.constraint(equalTo: signView.leadingAnchor, constant: 0),

            signInButton.centerYAnchor.constraint(equalTo: signView.centerYAnchor, constant: 0),
            signInButton.leadingAnchor.constraint(equalTo: signInLabel.trailingAnchor, constant: 10),
            signInButton.trailingAnchor.constraint(equalTo: signView.trailingAnchor, constant: 0),
            ])

    }

}
// 뷰 아무곳이나 누르면 키보드 내려가게
extension ViewController {
func hideKeyboardWhenTappedAround() {
let tapGesture = UITapGestureRecognizer(target: self,
action: #selector(hideKeyboard))
// 테이블 뷰나 컬렉션 뷰에서 설정안해주면 그 안에 있는 셀 클릭 이벤트 발생하지 않음.
tapGesture.cancelsTouchesInView = false
view.addGestureRecognizer(tapGesture)
}

    @objc func hideKeyboard() {

        view.endEditing(true)
    }

}

```

## Any question?🙋‍

코드에 문제가 있거나 어떤 질문이든 편하게 메일을 보내주세요!

Please email me with any questions or concerns! 😃<br/>
💌 : sch.haeun@gmail.com

```

```
